<div class="dashboard-container">
  <div class="dashboard-header">
    <h1>Dashboard Overview</h1>
    <p class="text-muted">Welcome back! Here's what's happening with your business.</p>
  </div>

  <div *ngIf="isLoading" class="loading-container">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <div class="stats-grid" *ngIf="!isLoading">
    <app-stat-card
      *ngFor="let stat of stats"
      [title]="stat.title"
      [count]="stat.count"
      [icon]="stat.icon"
      [color]="stat.color"
    ></app-stat-card>

    <div class="stat-card revenue-card">
      <div class="card-header">
        <i class="bi bi-currency-dollar"></i>
        <span>Total Revenue</span>
      </div>
      <div class="card-value">{{ formatCurrency(totalRevenue) }}</div>
    </div>

    <div class="stat-card rating-card">
      <div class="card-header">
        <i class="bi bi-star-fill"></i>
        <span>Average Rating</span>
      </div>
      <div class="card-value">{{ formatRating(averageRating) }} / 5.0</div>
    </div>
  </div>

  <div class="charts-section" *ngIf="!isLoading && analyticsData">
    <div class="row">
      <div class="col-md-6 mb-4">
        <div class="chart-card">
          <h3>Reservations by Status</h3>
          <div class="pie-chart-container">
            <div class="pie-chart">
              <svg viewBox="0 0 100 100" class="pie">
                <circle
                  *ngFor="let item of reservationChartData; let i = index"
                  [attr.cx]="50"
                  [attr.cy]="50"
                  [attr.r]="25"
                  [attr.fill]="'transparent'"
                  [attr.stroke]="item.color"
                  [attr.stroke-width]="50"
                  [attr.stroke-dasharray]="calculateStrokeDasharray(item.value, i)"
                  [attr.stroke-dashoffset]="calculateStrokeDashoffset(i)"
                ></circle>
              </svg>
            </div>
            <div class="pie-legend">
              <div *ngFor="let item of reservationChartData" class="legend-item">
                <span class="legend-color" [style.background-color]="item.color"></span>
                <span class="legend-label">{{ item.name }}: {{ item.value }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-6 mb-4">
        <div class="chart-card">
          <h3>User Growth (Monthly)</h3>
          <div class="line-chart-container">
            <div class="line-chart">
              <svg viewBox="0 0 500 300" preserveAspectRatio="xMidYMid meet">
                <line x1="50" y1="250" x2="450" y2="250" stroke="#e5e7eb" stroke-width="1" />
                <line x1="50" y1="200" x2="450" y2="200" stroke="#e5e7eb" stroke-width="1" />
                <line x1="50" y1="150" x2="450" y2="150" stroke="#e5e7eb" stroke-width="1" />
                <line x1="50" y1="100" x2="450" y2="100" stroke="#e5e7eb" stroke-width="1" />
                <line x1="50" y1="50" x2="450" y2="50" stroke="#e5e7eb" stroke-width="1" />
                
                <line x1="50" y1="50" x2="50" y2="250" stroke="#374151" stroke-width="2" />
                <line x1="50" y1="250" x2="450" y2="250" stroke="#374151" stroke-width="2" />
                
                <polyline
                  points="50,200 150,180 250,150 350,120 450,100"
                  fill="none"
                  stroke="#3b82f6"
                  stroke-width="3"
                />
                
                <text *ngFor="let item of monthlyUsersChartData; let i = index"
                      [attr.x]="50 + (i * 50)"
                      [attr.y]="270"
                      text-anchor="middle"
                      font-size="10"
                      fill="#6b7280">
                  {{ item.month }}
                </text>
              </svg>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-12">
        <div class="table-card">
          <h3>Top Rated Hotels</h3>
          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Hotel Name</th>
                  <th>Rating</th>
                  <th>Reservations</th>
                  <th>Revenue</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let hotel of topHotelsData; let i = index">
                  <td>{{ i + 1 }}</td>
                  <td>
                    <strong>{{ hotel.name }}</strong>
                  </td>
                  <td>
                    <div class="rating">
                      <i class="bi bi-star-fill text-warning"></i>
                      {{ formatRating(hotel.rating) }}
                    </div>
                  </td>
                  <td>
                    <span class="badge bg-primary">{{ hotel.reservationsCount }}</span>
                  </td>
                  <td>
                    <span class="text-success fw-bold">{{ formatCurrency(hotel.totalRevenue) }}</span>
                  </td>
                </tr>
                <tr *ngIf="topHotelsData.length === 0">
                  <td colspan="5" class="text-center text-muted">No data available</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="!isLoading && !analyticsData" class="empty-state">
    <i class="bi bi-inbox"></i>
    <p>No analytics data available</p>
  </div>
</div>