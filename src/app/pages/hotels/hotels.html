<div class="container-fluid mt-4 px-4">
  <!-- Header -->
  <div class="mb-4">
    <h1 class="display-5 fw-bold text-dark mb-2">Hotels Management</h1>
    <p class="text-muted">Admin Dashboard - View & Monitor Platform Hotels</p>
  </div>

  <!-- Stats Cards -->
  <div *ngIf="showStats && stats" class="row g-4 mb-4">
    <div class="col-md-3">
      <div class="card border-0 shadow-sm bg-primary text-white">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h6 class="text-white-50 mb-1">Total Hotels</h6>
              <h2 class="mb-0 fw-bold">{{ stats.totalHotels }}</h2>
            </div>
            <i class="bi bi-building fs-1 opacity-50"></i>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card border-0 shadow-sm bg-success text-white">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h6 class="text-white-50 mb-1">Average Price</h6>
              <h2 class="mb-0 fw-bold">${{ stats.averagePrice }}</h2>
            </div>
            <i class="bi bi-currency-dollar fs-1 opacity-50"></i>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card border-0 shadow-sm bg-warning text-white">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h6 class="text-white-50 mb-1">Average Rating</h6>
              <h2 class="mb-0 fw-bold">â˜… {{ stats.averageRating }}</h2>
            </div>
            <i class="bi bi-star-fill fs-1 opacity-50"></i>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card border-0 shadow-sm bg-info text-white">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h6 class="text-white-50 mb-1">Top City</h6>
              <h2 class="mb-0 fw-bold">{{ stats.topCities[0]?._id || 'N/A' }}</h2>
            </div>
            <i class="bi bi-geo-alt-fill fs-1 opacity-50"></i>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Filters -->
  <div class="card border-0 shadow-sm mb-4">
    <div class="card-body">
      <div class="row g-3">
        <div class="col-md-4">
          <input
            type="text"
            class="form-control"
            placeholder="ðŸ” Search hotels..."
            [(ngModel)]="searchTerm"
            (ngModelChange)="onSearchChange()"
          />
        </div>

        <div class="col-md-3">
          <select
            class="form-select"
            [(ngModel)]="filterCity"
            (ngModelChange)="onCityChange()"
          >
            <option value="">All Cities</option>
            <option *ngFor="let city of cities" [value]="city">{{ city }}</option>
          </select>
        </div>

        <div class="col-md-2">
          <button
            class="btn btn-secondary w-100"
            (click)="toggleStats()"
          >
            <i class="bi" [ngClass]="showStats ? 'bi-eye-slash' : 'bi-eye'"></i>
            {{ showStats ? 'Hide' : 'Show' }} Stats
          </button>
        </div>

        <div class="col-md-3 text-end">
          <span class="badge bg-light text-dark fs-6 py-2 px-3">
            Showing {{ filteredHotels.length }} of {{ hotels.length }}
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <!-- Table -->
  <div *ngIf="!loading" class="card border-0 shadow-sm">
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead class="table-dark">
            <tr>
              <th class="px-4 py-3">Image</th>
              <th class="px-4 py-3">Name</th>
              <th class="px-4 py-3">Location</th>
              <th class="px-4 py-3">Price</th>
              <th class="px-4 py-3">Rating</th>
              <th class="px-4 py-3">Amenities</th>
              <th class="px-4 py-3 text-center">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let hotel of filteredHotels; trackBy: trackById">
              <td class="px-4 py-3">
                <img
                  [src]="hotel.images[0] || 'https://via.placeholder.com/80'"
                  width="80"
                  height="60"
                  class="rounded shadow-sm object-fit-cover"
                  alt="Hotel"
                />
              </td>
              <td class="px-4 py-3 fw-semibold">{{ hotel.name }}</td>
              <td class="px-4 py-3">
                <i class="bi bi-geo-alt text-danger me-1"></i>
                {{ hotel.address.city }}, {{ hotel.address.country }}
              </td>
              <td class="px-4 py-3">
                <span class="badge bg-success-subtle text-success fs-6 fw-semibold">
                  ${{ hotel.price }}
                </span>
              </td>
              <td class="px-4 py-3">
                <span class="badge bg-warning text-dark">
                  â˜… {{ hotel.starRating.toFixed(1) }}
                </span>
              </td>
              <td class="px-4 py-3">
                <span class="badge bg-secondary me-1" *ngFor="let amenity of hotel.amenities.slice(0, 2)">
                  {{ amenity }}
                </span>
                <span *ngIf="hotel.amenities.length > 2" class="text-muted small">
                  +{{ hotel.amenities.length - 2 }}
                </span>
              </td>
              <td class="px-4 py-3">
                <div class="d-flex justify-content-center gap-2">
                  <button
                    class="btn btn-sm btn-info text-white"
                    (click)="openHotelDetails(hotel)"
                    title="View Details"
                  >
                    <i class="bi bi-eye"></i>
                  </button>
                  <button
                    class="btn btn-sm btn-danger"
                    (click)="deleteHotel(hotel)"
                    title="Delete"
                  >
                    <i class="bi bi-trash"></i>
                  </button>
                </div>
              </td>
            </tr>
            <tr *ngIf="filteredHotels.length === 0">
              <td colspan="7" class="text-center py-5 text-muted">
                <i class="bi bi-inbox fs-1 d-block mb-3"></i>
                No hotels found
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <app-hotel-modal
    *ngIf="selectedHotel"
    [hotel]="selectedHotel"
    (closeModal)="closeHotelDetails()"
  >
  </app-hotel-modal>
</div>